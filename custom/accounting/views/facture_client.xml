<?xml version="1.0" encoding="utf-8"?>

<odoo>
  <template id="facture_client_ba_m1">
    <t t-call="web.html_container">
      <t t-foreach="docs" t-as="o">
        <t t-call="web.basic_layout">
          <t t-set="lines" t-value="o.invoice_line_enter_ids" />
          <t t-set="pages" t-value="ceil(len(lines)/40)" />
          <t t-set="start" t-value="0" />
          <t t-set="end" t-value="40" />

          <style>
            *, p {
              margin: 0;
              padding: 0;
              
            }
            p {
              line-height: 1.1;
            }
            .page {
              font-size: 10pt;
              position: relative;
              height: 375mm;
            }
            td:not(.last-section td:nth-child(1)), th {
              padding: 1px 2px;
            }
        
            .logo {
              width: 170px;
            }
        
            .client-infos {
              width: 300px;
              text-align: center;
              float: right;
            }
        
            .clear {
              clear: both;
            }
        
            table {
              width: 100%;
            }
        
            .header-table {
              text-align: center;
              border-collapse: collapse;
            }
            
            .main-table {
              margin-top: 10px;
              border-collapse: collapse;
            }
        
            .header-table td, .header-table th,
            .main-table td, .main-table th {
              border-collapse: collapse;
              border: 1px solid black;
            }
        
            .main-table th {
              background-color: rgb(184, 184, 184);
              text-align: center;
            }
        
            .row-label {
              font-style: italic;
              background-color: rgb(143, 143, 143);
              font-size: 9pt;
              text-decoration: underline;
            }
            .main-table td:nth-child(3):not(.last-section td) {
              text-align: center;
            }
            .main-table td:nth-child(4), .main-table td:nth-child(5), .main-table td:nth-child(6), .last-section td:nth-child(3) {
              text-align: right;
            }
            .gl {
              background-color: rgb(143, 143, 143);
            }
            .last-section td:nth-child(1) {
              border: none;
            }
            .igaser-footer {
              position: absolute;
              bottom: 0px;
              width: 100%;
              }
  
              .footer-elements {
              }
  
              .igaser-footer .txt {
              float: left;
              margin-top: 30px;
              }
  
              .igaser-footer .img {
              width : 200px;
              float: right;
              }
  
              .website, .bar {
              display: inline;
              }
  
              .bar {
              height: 1px;
              width: 87%;
              float: right;
              background-color: rgb(236, 79, 26);
              display: inline-block;
              margin: 8px 0;
              border: 0px;
              }
  
              .website {
              float: left;
              color: rgb(0, 89, 167);
              }
          </style>

          <t t-if="pages == 0">
            <div class="page">
              <img src="/building/static/src/img/logo.jpg" class="logo" />
              <br/>
              <div class="client-infos">
                <p><span t-field="o.partner_id.name"/></p>
                <p>ICE : <span t-field="o.partner_id.ice"/></p>
                <p><span t-field="o.partner_id.street"/> <span t-field="o.partner_id.street2"/></p>
                <p><span t-field="o.partner_id.city"/></p>
              </div>
              <div class="clear"/>
              <p>Facture n°: <span t-field="o.name"/></p>
              <p>El jadida, Le <span t-esc='o.invoice_date.strftime("%d/%m/%Y")'/></p>
              <table class="header-table">
                <tr>
                  <th width="70%">Objet</th>
                  <th>Référence</th>
                </tr>
                <tr>
                  <td><span t-esc='o.site_id.name' /></td>
                  <td><p>DECOMPTE N° <span t-esc='o.attachment_id.name' /></p></td>
                </tr>
              </table>
              <table class="main-table">
                <tr>
                  <th width="3%">N°</th>
                  <th>DÉSIGNATION DES OUVRAGES</th>
                  <th>U</th>
                  <th>QUANTITÉ</th>
                  <th>P.U HT</th>
                  <th>PRIX TOTAL HT</th>
                </tr>
                <t t-foreach="lines" t-as="line">
                  <t t-if='line["display_type"]'>
                    <tr>
                      <td></td>
                      <td class="row-label"><span t-esc='line["name"]'/></td>
                      <td></td>
                      <td></td>
                      <td></td>
                      <td></td>
                    </tr>
                  </t>
                  <t t-else="">
                    <tr>
                      <td></td>
                      <td>
                        <span t-esc='line["name"]' />
                      </td>
                      <td>
                        <span t-esc='line["product_uom_id"]["name"]' />
                      </td>
                      <td>
                        <span t-esc='line["cumulative_quantity"]'
                          t-options='{"widget": "float", "precision": 2}' />
                      </td>
                      <td>
                        <span t-esc='line["price_unit"]'
                          t-options='{"widget": "float", "precision": 2}' />
                      </td>
                      <td>
                        <span t-esc='line["cumulative_price_subtotal"]'
                          t-options='{"widget": "float", "precision": 2}' />
                      </td>
                    </tr>
                  </t>
                </t>
                <t t-if="o.site_id.is_tax_exempt">
                  <tr>
                    <td></td>
                    <td>Exonéré de TVA suivant attestation <span t-field="o.site_id.exemption_certificate_ref"/></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                  </tr>
                </t>
                <tr class="last-section">
                  <td colspan="2"></td>
                  <td class="gl" colspan="3">TOTAL EN DHS H.T</td>
                  <td class="gl"><span t-esc="o.cumul_amount_untaxed" t-options='{"widget": "float", "precision": 2}' /></td>
                </tr>
                <tr class="last-section">
                  <t t-set="deduire_dps_m1" t-value="o.prev_amount_previous_inv_attachment_deduction + o.site_id.cumulative_counts" />
                  <td colspan="2"></td>
                  <td class="gl" colspan="3">A DEDUIRE DPS M-1</td>
                  <td class="gl"><span t-esc="deduire_dps_m1" t-options='{"widget": "float", "precision": 2}' /></td>
                </tr>
                <tr class="last-section">
                  <t t-set="net_ht" t-value="o.cumul_amount_untaxed - deduire_dps_m1" />
                  <td colspan="2"></td>
                  <td class="gl" colspan="3">NET HT</td>
                  <td class="gl"><span t-esc="net_ht"
                    t-options='{"widget": "float", "precision": 2}' /></td>
                </tr>
                <tr class="last-section">
                  <t t-set="tva" t-value="0" />
                  <td colspan="2"></td>
                  <td class="gl" colspan="3">TVA</td>
                  <t t-if="o.site_id.is_tax_exempt">
                    <td class="gl">EXONEREE</td>
                  </t>
                  <t t-else="">
                    <t t-set="tva" t-value="net_ht * 0.2" />
                    <td class="gl"><span t-esc="tva"
                      t-options='{"widget": "float", "precision": 2}' /></td>
                  </t>
                </tr>
                <t t-if="o.site_id.prc_gr > 0">
                  <tr class="last-section">
                    <t t-set="total" t-value="tva + net_ht" />
                    <td colspan="2"></td>
                    <td class="gl" colspan="3">TOTAL EN DHS T.T.C</td>
                    <td class="gl"><span t-esc="total"
                      t-options='{"widget": "float", "precision": 2}' /></td>
                  </tr>
                  <tr class="last-section">
                    <t t-set="total_rg" t-value="total * (o.site_id.prc_gr/100)" />
                    <td colspan="2"></td>
                    <td class="gl" colspan="3">RG <span t-field="o.site_id.prc_gr"
                        t-options="{&quot;widget&quot;: &quot;float&quot;, &quot;precision&quot;: 0}" />
                      %</td>
                    <td class="gl">
                      <span t-esc="total_rg"
                        t-options="{&quot;widget&quot;: &quot;float&quot;, &quot;precision&quot;: 2}" />
                    </td>
                  </tr>
                  <tr class="last-section">
                    <t t-set="total_net" t-value="total - total_rg" />
                    <td colspan="2">Arrêtée la Présente Facture a la somme de:</td>
                    <td class="gl" colspan="3">TOTAL NET À PAYER</td>
                    <td class="gl">
                      <span t-esc="total_net"
                        t-options="{&quot;widget&quot;: &quot;float&quot;, &quot;precision&quot;: 2}" />
                    </td>
                  </tr>
                </t>
                <t t-else="">
                  <tr class="last-section">
                    <t t-set="total" t-value="tva + net_ht" />
                    <td colspan="2">Arrêtée la Présente Facture a la somme de:</td>
                    <td class="gl" colspan="3">TOTAL EN DHS T.T.C</td>
                    <td class="gl"><span t-esc="total"
                      t-options='{"widget": "float", "precision": 2}' /></td>
                  </tr>
                </t>
              </table>
              <t t-if="o.site_id.prc_gr &gt; 0">
                <p>
                  <span t-esc="(o.amount_in_word(total_net)).capitalize()" />
                </p>
              </t>
              <t t-else="">
                <p>
                  <span t-esc="(o.amount_in_word(total)).capitalize()" />
                </p>
              </t>
    
              <div class="igaser-footer">
                <div class="txt">
                  <p>
                    SARL au capital de 40.000.000,00 dh - siège social : lot 313-315 Zone
                    industriel-El Jadida - ICE: 000087398000070
                  </p>
                  <p>
                    Tel: 05 23 35 29 00 - Fax: 05 23 35 29 01 - PatenteL 42104582 - RC: 3013
                    - CNSS: 2703892 - IF: 05701046
                  </p>
                </div>
                <img class='img' src="/accounting_igaser/static/src/img/pfEkrlb.jpeg" />
                <div class="clear" />
                <p class="website bold">www.igaser.com</p>
                <hr class="bar" />
              </div>
              </div>
          </t>
          <t t-else="">
            <t t-foreach="range(pages)" t-as="page">
              <div class="page">
              <img src="/building/static/src/img/logo.jpg" class="logo" />
              <br/>
              <div class="client-infos">
                <p><span t-field="o.partner_id.name"/></p>
                <p>ICE : <span t-field="o.partner_id.ice"/></p>
                <p><span t-field="o.partner_id.street"/> <span t-field="o.partner_id.street2"/></p>
                <p><span t-field="o.partner_id.city"/></p>
              </div>
              <div class="clear"/>
              <p>Facture n°: <span t-field="o.name"/></p>
              <p>El jadida, Le <span t-esc='o.invoice_date.strftime("%d/%m/%Y")'/></p>
              <table class="header-table">
                <tr>
                  <th width="70%">Objet</th>
                  <th>Référence</th>
                </tr>
                <tr>
                  <td><span t-esc='o.site_id.name' /></td>
                  <td><p>DECOMPTE N° <span t-esc='o.attachment_id.name' /></p></td>
                </tr>
              </table>
              <table class="main-table">
                <tr>
                  <th width="3%">N°</th>
                  <th>DÉSIGNATION DES OUVRAGES</th>
                  <th>U</th>
                  <th>QUANTITÉ</th>
                  <th>P.U HT</th>
                  <th>PRIX TOTAL HT</th>
                </tr>
                <t t-foreach="lines[start:end]" t-as="line">
                  <t t-if='line["display_type"]'>
                    <tr>
                      <td></td>
                      <td class="row-label"><span t-esc='line["name"]'/></td>
                      <td></td>
                      <td></td>
                      <td></td>
                      <td></td>
                    </tr>
                  </t>
                  <t t-else="">
                    <tr>
                      <td></td>
                      <td>
                        <span t-esc='line["name"]' />
                      </td>
                      <td>
                        <span t-esc='line["product_uom_id"]["name"]' />
                      </td>
                      <td>
                        <span t-esc='line["cumulative_quantity"]'
                          t-options='{"widget": "float", "precision": 2}' />
                      </td>
                      <td>
                        <span t-esc='line["price_unit"]'
                          t-options='{"widget": "float", "precision": 2}' />
                      </td>
                      <td>
                        <span t-esc='line["cumulative_price_subtotal"]'
                          t-options='{"widget": "float", "precision": 2}' />
                      </td>
                    </tr>
                  </t>
                </t>
                <t t-if="o.site_id.is_tax_exempt">
                  <tr>
                    <td></td>
                    <td>Exonéré de TVA suivant attestation <span t-field="o.site_id.exemption_certificate_ref"/></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                  </tr>
                </t>
                <t t-if="page + 1 == pages">
  
                  <tr class="last-section">
                    <td colspan="2"></td>
                    <td class="gl" colspan="3">TOTAL EN DHS H.T</td>
                    <td class="gl"><span t-esc="o.cumul_amount_untaxed" t-options='{"widget": "float", "precision": 2}' /></td>
                  </tr>
                  <tr class="last-section">
                    <t t-set="deduire_dps_m1" t-value="o.prev_amount_previous_inv_attachment_deduction + o.site_id.cumulative_counts" />
                    <td colspan="2"></td>
                    <td class="gl" colspan="3">A DEDUIRE DPS M-1</td>
                    <td class="gl"><span t-esc="deduire_dps_m1" t-options='{"widget": "float", "precision": 2}' /></td>
                  </tr>
                  <tr class="last-section">
                    <t t-set="net_ht" t-value="o.cumul_amount_untaxed - deduire_dps_m1" />
                    <td colspan="2"></td>
                    <td class="gl" colspan="3">NET HT</td>
                    <td class="gl"><span t-esc="net_ht"
                      t-options='{"widget": "float", "precision": 2}' /></td>
                  </tr>
                  <tr class="last-section">
                    <t t-set="tva" t-value="0" />
                    <td colspan="2"></td>
                    <td class="gl" colspan="3">TVA</td>
                    <t t-if="o.site_id.is_tax_exempt">
                      <td class="gl">EXONEREE</td>
                    </t>
                    <t t-else="">
                      <t t-set="tva" t-value="net_ht * 0.2" />
                      <td class="gl"><span t-esc="tva"
                        t-options='{"widget": "float", "precision": 2}' /></td>
                    </t>
                  </tr>
                  <t t-if="o.site_id.prc_gr > 0">
                    <tr class="last-section">
                      <t t-set="total" t-value="tva + net_ht" />
                      <td colspan="2"></td>
                      <td class="gl" colspan="3">TOTAL EN DHS T.T.C</td>
                      <td class="gl"><span t-esc="total"
                        t-options='{"widget": "float", "precision": 2}' /></td>
                    </tr>
                    <tr class="last-section">
                      <t t-set="total_rg" t-value="total * (o.site_id.prc_gr/100)" />
                      <td colspan="2"></td>
                      <td class="gl" colspan="3">RG <span t-field="o.site_id.prc_gr"
                          t-options="{&quot;widget&quot;: &quot;float&quot;, &quot;precision&quot;: 0}" />
                        %</td>
                      <td class="gl">
                        <span t-esc="total_rg"
                          t-options="{&quot;widget&quot;: &quot;float&quot;, &quot;precision&quot;: 2}" />
                      </td>
                    </tr>
                    <tr class="last-section">
                      <t t-set="total_net" t-value="total - total_rg" />
                      <td colspan="2">Arrêtée la Présente Facture a la somme de:</td>
                      <td class="gl" colspan="3">TOTAL NET À PAYER</td>
                      <td class="gl">
                        <span t-esc="total_net"
                          t-options="{&quot;widget&quot;: &quot;float&quot;, &quot;precision&quot;: 2}" />
                      </td>
                    </tr>
                  </t>
                  <t t-else="">
                    <tr class="last-section">
                      <t t-set="total" t-value="tva + net_ht" />
                      <td colspan="2">Arrêtée la Présente Facture a la somme de:</td>
                      <td class="gl" colspan="3">TOTAL EN DHS T.T.C</td>
                      <td class="gl"><span t-esc="total"
                        t-options='{"widget": "float", "precision": 2}' /></td>
                    </tr>
                  </t>
                </t>
              </table>
              <t t-if="page + 1 == pages">
                <t t-if="o.site_id.prc_gr &gt; 0">
                  <p>
                    <span t-esc="(o.amount_in_word(total_net)).capitalize()" />
                  </p>
                </t>
                <t t-else="">
                  <p>
                    <span t-esc="(o.amount_in_word(total)).capitalize()" />
                  </p>
                </t>
              </t>
    
              <div class="igaser-footer">
                <div class="txt">
                  <p>
                    SARL au capital de 40.000.000,00 dh - siège social : lot 313-315 Zone
                    industriel-El Jadida - ICE: 000087398000070
                  </p>
                  <p>
                    Tel: 05 23 35 29 00 - Fax: 05 23 35 29 01 - PatenteL 42104582 - RC: 3013
                    - CNSS: 2703892 - IF: 05701046
                  </p>
                </div>
                <img class='img' src="/accounting_igaser/static/src/img/pfEkrlb.jpeg" />
                <div class="clear" />
                <p class="website bold">www.igaser.com</p>
                <hr class="bar" />
              </div>
              </div>
              
              <t t-set="start" t-value="start + 40" />
              <t t-set="end" t-value="end + 40" />
            </t>
          </t>

        </t>
      </t>
    </t>
  </template>

  <template id="facture_client_ba_m2">
    <t t-call="web.html_container">
      <t t-foreach="docs" t-as="o">
        <t t-call="web.basic_layout">
          <t t-set="lines" t-value="o.get_invoice_statement_lines()" />
          <t t-set="pages" t-value="ceil(len(lines)/40)" />
          <t t-set="net_ht" t-value="0" />
          <t t-set="start" t-value="0" />
          <t t-set="end" t-value="40" />

          <style>
            *, p {
              margin: 0;
              padding: 0;
              
            }
            p {
              line-height: 1.1;
            }
            .page {
              font-size: 10pt;
              position: relative;
              height: 375mm;
            }
            td:not(.last-section td:nth-child(1)), th {
              padding: 1px 2px;
            }
        
            .logo {
              width: 170px;
            }
        
            .client-infos {
              width: 300px;
              text-align: center;
              float: right;
            }
        
            .clear {
              clear: both;
            }
        
            table {
              width: 100%;
            }
        
            .header-table {
              text-align: center;
              border-collapse: collapse;
            }
            
            .main-table {
              margin-top: 10px;
              border-collapse: collapse;
            }
        
            .header-table td, .header-table th,
            .main-table td, .main-table th {
              border-collapse: collapse;
              border: 1px solid black;
            }
        
            .main-table th {
              background-color: rgb(184, 184, 184);
              text-align: center;
            }
        
            .row-label {
              font-style: italic;
              background-color: rgb(143, 143, 143);
              font-size: 9pt;
              text-decoration: underline;
            }
            .main-table td:nth-child(3):not(.last-section td) {
              text-align: center;
            }
            .main-table td:nth-child(4), .main-table td:nth-child(5), .main-table td:nth-child(6), .last-section td:nth-child(3) {
              text-align: right;
            }
            .gl {
              background-color: rgb(143, 143, 143);
            }
            .last-section td:nth-child(1) {
              border: none;
            }
            .igaser-footer {
              position: absolute;
              bottom: 0px;
              width: 100%;
              }
  
              .footer-elements {
              }
  
              .igaser-footer .txt {
              float: left;
              margin-top: 30px;
              }
  
              .igaser-footer .img {
              width : 200px;
              float: right;
              }
  
              .website, .bar {
              display: inline;
              }
  
              .bar {
              height: 1px;
              width: 87%;
              float: right;
              background-color: rgb(236, 79, 26);
              display: inline-block;
              margin: 8px 0;
              border: 0px;
              }
  
              .website {
              float: left;
              color: rgb(0, 89, 167);
              }
          </style>

          <t t-if="pages == 0">
            <div class="page">
              <img src="/building/static/src/img/logo.jpg" class="logo" />
              <br/>
              <div class="client-infos">
                <p><span t-field="o.partner_id.name"/></p>
                <p>ICE : <span t-field="o.partner_id.ice"/></p>
                <p><span t-field="o.partner_id.street"/> <span t-field="o.partner_id.street2"/></p>
                <p><span t-field="o.partner_id.city"/></p>
              </div>
              <div class="clear"/>
              <p>Facture n°: <span t-field="o.name"/></p>
              <p>El jadida, Le <span t-esc='o.invoice_date.strftime("%d/%m/%Y")'/></p>
              <table class="header-table">
                <tr>
                  <th width="70%">Objet</th>
                  <th>Référence</th>
                </tr>
                <tr>
                  <td><span t-esc='o.site_id.name' /></td>
                  <td><p>DECOMPTE N° <span t-esc='o.attachment_id.name' /></p></td>
                </tr>
              </table>
              <table class="main-table">
                <tr>
                  <th width="3%">N°</th>
                  <th>DÉSIGNATION DES OUVRAGES</th>
                  <th>U</th>
                  <th>QUANTITÉ</th>
                  <th>P.U HT</th>
                  <th>PRIX TOTAL HT</th>
                </tr>
                <t t-foreach="lines[start:end]" t-as="line">
                  <t t-if='line["display_type"]'>
                    <tr>
                      <td></td>
                      <td class="row-label"><span t-esc='line["name"]'/></td>
                      <td></td>
                      <td></td>
                      <td></td>
                      <td></td>
                    </tr>
                  </t>
                  <t t-else="">
                    <tr>
                      <td></td>
                      <td>
                        <span t-esc='line["name"]' />
                      </td>
                      <td>
                        <span t-esc='line["product_uom_id"]["name"]' />
                      </td>
                      <td>
                        <span t-esc='line["current_count_quantity"]'
                          t-options='{"widget": "float", "precision": 2}' />
                      </td>
                      <td>
                        <span t-esc='line["price_unit"]'
                          t-options='{"widget": "float", "precision": 2}' />
                      </td>
                      <td>
                        <t t-set="net_ht" t-value="net_ht + line['current_price_subtotal']" />
                        <span t-esc='line["current_price_subtotal"]'
                          t-options='{"widget": "float", "precision": 2}' />
                      </td>
                    </tr>
                  </t>
                </t>
                <t t-set="tva" t-value="net_ht * 0.2" />
                <t t-if="o.site_id.is_tax_exempt">
                  <t t-set="tva" t-value="0" />
                  <tr>
                    <td></td>
                    <td>Exonéré de TVA suivant attestation <span t-field="o.site_id.exemption_certificate_ref"/></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                  </tr>
                </t>
                <t t-set="total" t-value="tva + net_ht" />
                <tr class="last-section">
                  <td colspan="2"></td>
                  <td class="gl" colspan="3">TOTAL EN DHS H.T</td>
                  <td class="gl"><span t-esc="net_ht" t-options='{"widget": "float", "precision": 2}' /></td>
                </tr>
                <tr class="last-section">
                  <td colspan="2"></td>
                  <td class="gl" colspan="3">TVA</td>
                  <t t-if="o.site_id.is_tax_exempt">
                    <td class="gl">EXONEREE</td>
                  </t>
                  <t t-else="">
                    <td class="gl"><span t-esc="tva"
                      t-options='{"widget": "float", "precision": 2}' /></td>
                  </t>
                </tr>
                <t t-if="o.site_id.prc_gr > 0">
                  <tr class="last-section">
                    <t t-set="total" t-value="tva + net_ht" />
                    <td colspan="2"></td>
                    <td class="gl" colspan="3">TOTAL EN DHS T.T.C</td>
                    <td class="gl"><span t-esc="total"
                      t-options='{"widget": "float", "precision": 2}' /></td>
                  </tr>
                  <tr class="last-section">
                    <t t-set="total_rg" t-value="total * (o.site_id.prc_gr/100)" />
                    <td colspan="2"></td>
                    <td class="gl" colspan="3">RG <span t-field="o.site_id.prc_gr"
                        t-options="{&quot;widget&quot;: &quot;float&quot;, &quot;precision&quot;: 0}" />
                      %</td>
                    <td class="gl">
                      <span t-esc="total_rg"
                        t-options="{&quot;widget&quot;: &quot;float&quot;, &quot;precision&quot;: 2}" />
                    </td>
                  </tr>
                  <tr class="last-section">
                    <t t-set="total_net" t-value="total - total_rg" />
                    <td colspan="2">Arrêtée la Présente Facture a la somme de:</td>
                    <td class="gl" colspan="3">TOTAL NET À PAYER</td>
                    <td class="gl">
                      <span t-esc="total_net"
                        t-options="{&quot;widget&quot;: &quot;float&quot;, &quot;precision&quot;: 2}" />
                    </td>
                  </tr>
                </t>
                <t t-else="">
                  <tr class="last-section">
                    <t t-set="total" t-value="tva + net_ht" />
                    <td colspan="2">Arrêtée la Présente Facture a la somme de:</td>
                    <td class="gl" colspan="3">TOTAL EN DHS T.T.C</td>
                    <td class="gl"><span t-esc="total"
                      t-options='{"widget": "float", "precision": 2}' /></td>
                  </tr>
                </t>
              </table>
              <t t-if="o.site_id.prc_gr &gt; 0">
                <p>
                  <span t-esc="(o.amount_in_word(total_net)).capitalize()" />
                </p>
              </t>
              <t t-else="">
                <p>
                  <span t-esc="(o.amount_in_word(total)).capitalize()" />
                </p>
              </t>
    
              <div class="igaser-footer">
                <div class="txt">
                  <p>
                    SARL au capital de 40.000.000,00 dh - siège social : lot 313-315 Zone
                    industriel-El Jadida - ICE: 000087398000070
                  </p>
                  <p>
                    Tel: 05 23 35 29 00 - Fax: 05 23 35 29 01 - PatenteL 42104582 - RC: 3013
                    - CNSS: 2703892 - IF: 05701046
                  </p>
                </div>
                <img class='img' src="/accounting_igaser/static/src/img/pfEkrlb.jpeg" />
                <div class="clear" />
                <p class="website bold">www.igaser.com</p>
                <hr class="bar" />
              </div>
              </div>
          </t>
          <t t-else="">
            <t t-foreach="range(pages)" t-as="page">
              <div class="page">
              <img src="/building/static/src/img/logo.jpg" class="logo" />
              <br/>
              <div class="client-infos">
                <p><span t-field="o.partner_id.name"/></p>
                <p>ICE : <span t-field="o.partner_id.ice"/></p>
                <p><span t-field="o.partner_id.street"/> <span t-field="o.partner_id.street2"/></p>
                <p><span t-field="o.partner_id.city"/></p>
              </div>
              <div class="clear"/>
              <p>Facture n°: <span t-field="o.name"/></p>
              <p>El jadida, Le <span t-esc='o.invoice_date.strftime("%d/%m/%Y")'/></p>
              <table class="header-table">
                <tr>
                  <th width="70%">Objet</th>
                  <th>Référence</th>
                </tr>
                <tr>
                  <td><span t-esc='o.site_id.name' /></td>
                  <td><p>DECOMPTE N° <span t-esc='o.attachment_id.name' /></p></td>
                </tr>
              </table>
              <table class="main-table">
                <tr>
                  <th width="3%">N°</th>
                  <th>DÉSIGNATION DES OUVRAGES</th>
                  <th>U</th>
                  <th>QUANTITÉ</th>
                  <th>P.U HT</th>
                  <th>PRIX TOTAL HT</th>
                </tr>
                <t t-foreach="lines[start:end]" t-as="line">
                  <t t-if='line["display_type"]'>
                    <tr>
                      <td></td>
                      <td class="row-label"><span t-esc='line["name"]'/></td>
                      <td></td>
                      <td></td>
                      <td></td>
                      <td></td>
                    </tr>
                  </t>
                  <t t-else="">
                    <tr>
                      <td></td>
                      <td>
                        <span t-esc='line["name"]' />
                      </td>
                      <td>
                        <span t-esc='line["product_uom_id"]["name"]' />
                      </td>
                      <td>
                        <span t-esc='line["current_count_quantity"]'
                          t-options='{"widget": "float", "precision": 2}' />
                      </td>
                      <td>
                        <span t-esc='line["price_unit"]'
                          t-options='{"widget": "float", "precision": 2}' />
                      </td>
                      <td>
                        <t t-set="net_ht" t-value="net_ht + line['current_price_subtotal']" />
                        <span t-esc='line["current_price_subtotal"]'
                          t-options='{"widget": "float", "precision": 2}' />
                      </td>
                    </tr>
                  </t>
                </t>
                <t t-set="tva" t-value="net_ht * 0.2" />
                <t t-if="o.site_id.is_tax_exempt">
                  <t t-set="tva" t-value="0" />
                  <tr>
                    <td></td>
                    <td>Exonéré de TVA suivant attestation <span t-field="o.site_id.exemption_certificate_ref"/></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                  </tr>
                </t>
                <t t-if="page + 1 == pages">
                  <t t-set="total" t-value="tva + net_ht" />
                  <tr class="last-section">
                    <td colspan="2"></td>
                    <td class="gl" colspan="3">TOTAL EN DHS H.T</td>
                    <td class="gl"><span t-esc="net_ht" t-options='{"widget": "float", "precision": 2}' /></td>
                  </tr>
                  <tr class="last-section">
                    <td colspan="2"></td>
                    <td class="gl" colspan="3">TVA</td>
                    <t t-if="o.site_id.is_tax_exempt">
                      <td class="gl">EXONEREE</td>
                    </t>
                    <t t-else="">
                      <td class="gl"><span t-esc="tva"
                        t-options='{"widget": "float", "precision": 2}' /></td>
                    </t>
                  </tr>
                  <t t-if="o.site_id.prc_gr > 0">
                    <tr class="last-section">
                      <t t-set="total" t-value="tva + net_ht" />
                      <td colspan="2"></td>
                      <td class="gl" colspan="3">TOTAL EN DHS T.T.C</td>
                      <td class="gl"><span t-esc="total"
                        t-options='{"widget": "float", "precision": 2}' /></td>
                    </tr>
                    <tr class="last-section">
                      <t t-set="total_rg" t-value="total * (o.site_id.prc_gr/100)" />
                      <td colspan="2"></td>
                      <td class="gl" colspan="3">RG <span t-field="o.site_id.prc_gr"
                          t-options="{&quot;widget&quot;: &quot;float&quot;, &quot;precision&quot;: 0}" />
                        %</td>
                      <td class="gl">
                        <span t-esc="total_rg"
                          t-options="{&quot;widget&quot;: &quot;float&quot;, &quot;precision&quot;: 2}" />
                      </td>
                    </tr>
                    <tr class="last-section">
                      <t t-set="total_net" t-value="total - total_rg" />
                      <td colspan="2">Arrêtée la Présente Facture a la somme de:</td>
                      <td class="gl" colspan="3">TOTAL NET À PAYER</td>
                      <td class="gl">
                        <span t-esc="total_net"
                          t-options="{&quot;widget&quot;: &quot;float&quot;, &quot;precision&quot;: 2}" />
                      </td>
                    </tr>
                  </t>
                  <t t-else="">
                    <tr class="last-section">
                      <t t-set="total" t-value="tva + net_ht" />
                      <td colspan="2">Arrêtée la Présente Facture a la somme de:</td>
                      <td class="gl" colspan="3">TOTAL EN DHS T.T.C</td>
                      <td class="gl"><span t-esc="total"
                        t-options='{"widget": "float", "precision": 2}' /></td>
                    </tr>
                  </t>
                </t>
              </table>
              <t t-if="page + 1 == pages">
                <t t-if="o.site_id.prc_gr &gt; 0">
                  <p>
                    <span t-esc="(o.amount_in_word(total_net)).capitalize()" />
                  </p>
                </t>
                <t t-else="">
                  <p>
                    <span t-esc="(o.amount_in_word(total)).capitalize()" />
                  </p>
                </t>
              </t>
    
              <div class="igaser-footer">
                <div class="txt">
                  <p>
                    SARL au capital de 40.000.000,00 dh - siège social : lot 313-315 Zone
                    industriel-El Jadida - ICE: 000087398000070
                  </p>
                  <p>
                    Tel: 05 23 35 29 00 - Fax: 05 23 35 29 01 - PatenteL 42104582 - RC: 3013
                    - CNSS: 2703892 - IF: 05701046
                  </p>
                </div>
                <img class='img' src="/accounting_igaser/static/src/img/pfEkrlb.jpeg" />
                <div class="clear" />
                <p class="website bold">www.igaser.com</p>
                <hr class="bar" />
              </div>
              </div>
              
              <t t-set="start" t-value="start + 40" />
              <t t-set="end" t-value="end + 40" />
            </t>
          </t>
        </t>
      </t>
    </t>
  </template>

  <template id="facture_client">
    <t t-call="web.html_container">
      <t t-foreach="docs" t-as="o">
        <t t-call="web.basic_layout">
          <t t-set="lines" t-value="o.invoice_line_ids" />
          <t t-set="pages" t-value="ceil(len(lines)/40)" />
          <t t-set="start" t-value="0" />
          <t t-set="end" t-value="40" />

          <style>
            *, p {
              margin: 0;
              padding: 0;
              
            }
            p {
              line-height: 1.1;
            }
            .page {
              font-size: 10pt;
              position: relative;
              height: 375mm;
            }
            td:not(.last-section td:nth-child(1)), th {
              padding: 1px 2px;
            }
        
            .logo {
              width: 170px;
            }
        
            .client-infos {
              width: 300px;
              text-align: center;
              float: right;
            }
        
            .clear {
              clear: both;
            }
        
            table {
              width: 100%;
            }
        
            .header-table {
              text-align: center;
              border-collapse: collapse;
            }
            
            .main-table {
              margin-top: 10px;
              border-collapse: collapse;
            }
        
            .header-table td, .header-table th, .main-table th {
              border-collapse: collapse;
              border: 1px solid black;
            }
        
            .main-table th {
              text-align: center;
            }
        
            .row-label {
              font-style: italic;
              background-color: rgb(143, 143, 143);
              font-size: 9pt;
              text-decoration: underline;
            }
            .main-table td:nth-child(2):not(.last-section td) {
              text-align: center;
            }
            .main-table td:nth-child(3), .main-table td:nth-child(4), .main-table td:nth-child(5), .last-section td:nth-child(3) {
              text-align: right;
            }
            .last-section td:nth-child(1) {
              border: none;
            }
            .igaser-footer {
              position: absolute;
              bottom: 0px;
              width: 100%;
              }
      
              .igaser-footer .txt {
              float: left;
              margin-top: 30px;
              }
      
              .igaser-footer .img {
              width : 200px;
              float: right;
              }
      
              .website, .bar {
              display: inline;
              }
      
              .bar {
              height: 1px;
              width: 87%;
              float: right;
              background-color: rgb(236, 79, 26);
              display: inline-block;
              margin: 8px 0;
              border: 0px;
              }
      
              .website {
              float: left;
              color: rgb(0, 89, 167);
              }

              .main-table td {
                border-right: 1px solid black;
                border-left: 1px solid black;
              }

              .last-td {
                border-bottom: 1px solid black !important;
              }
          </style>

          <t t-if="page == 0">
            <div class="page">
              <img src="/building/static/src/img/logo.jpg" class="logo" />
              <br/>
              <div class="client-infos">
                <p><span t-field="o.partner_id.name"/></p>
                <p>ICE : <span t-field="o.partner_id.ice"/></p>
                <p><span t-field="o.partner_id.street"/> <span t-field="o.partner_id.street2"/></p>
                <p><span t-field="o.partner_id.city"/></p>
              </div>
              <div class="clear"></div>
              <p>Facture n°: <span t-field="o.name"/></p>
              <p>El jadida, Le <span t-esc='o.invoice_date.strftime("%d/%m/%Y")'/></p>
              <table class="header-table">
                <tr>
                  <th width="70%">Objet</th>
                  <th>Référence</th>
                </tr>
                <tr>
                  <td><span t-esc='o.invoice_object' /></td>
                  <td><span t-esc="o.reference"/></td>
                </tr>
              </table>
              <table class="main-table">
                <tr>
                  <th>DÉSIGNATION</th>
                  <th>UNITÉ</th>
                  <th>QUANTITÉ</th>
                  <th>PRIX HT</th>
                  <th>MONTANT HT</th>
                </tr>
                <t t-set="last_id" t-value="lines[-1].id" />
                <t t-foreach="lines[start:end]" t-as="line">
                    <t t-if="line.id == last_id">
                      <tr>
                        <td class="last-td">
                          <span t-esc='line.name' />
                        </td>
                        <td class="last-td">
                          <span t-esc='line.product_uom_id.name' />
                        </td>
                        <td class="last-td">
                          <span t-esc='line.quantity'
                            t-options='{"widget": "float", "precision": 2}' />
                        </td>
                        <td class="last-td">
                          <span t-esc='line.price_unit'
                            t-options='{"widget": "float", "precision": 2}' />
                        </td>
                        <td class="last-td">
                          <span t-esc='line.price_subtotal'
                            t-options='{"widget": "float", "precision": 2}' />
                        </td>
                      </tr>
                    </t>
                    <t t-else="">
                      <tr>
                        <td>
                          <span t-esc='line.name' />
                        </td>
                        <td>
                          <span t-esc='line.product_uom_id.name' />
                        </td>
                        <td>
                          <span t-esc='line.quantity'
                            t-options='{"widget": "float", "precision": 2}' />
                        </td>
                        <td>
                          <span t-esc='line.price_unit'
                            t-options='{"widget": "float", "precision": 2}' />
                        </td>
                        <td>
                          <span t-esc='line.price_subtotal'
                            t-options='{"widget": "float", "precision": 2}' />
                        </td>
                      </tr>
                    </t>
                </t>
                <t t-if="o.site_id.is_tax_exempt">
                  <tr>
                    <td class="last-td">Exonéré de TVA suivant attestation <span t-field="o.site_id.exemption_certificate_ref"/></td>
                    <td class="last-td"></td>
                    <td class="last-td"></td>
                    <td class="last-td"></td>
                    <td class="last-td"></td>
                  </tr>
                </t>
                <tr class="last-section">
                  <td colspan="2"></td>
                  <td class="gl" colspan="2">TOTAL H.T</td>
                  <td class="gl"><span t-esc="o.amount_untaxed" t-options='{"widget": "float", "precision": 2}' /></td>
                </tr>
                <tr class="last-section">
                  <td colspan="2"></td>
                  <td class="gl" colspan="2">TVA 20%</td>
                  <t t-if="o.site_id.is_tax_exempt">
                    <td class="gl">EXONEREE</td>
                  </t>
                  <t t-else="">
                    <td class="gl"><span t-esc="o.amount_tax"
                      t-options='{"widget": "float", "precision": 2}' /></td>
                  </t>
                </tr>
                <tr class="last-section">
                  <td colspan="2">Arrêtée la Présente Facture a la somme de:</td>
                  <td class="gl last-td" colspan="2">TOTAL T.T.C</td>
                  <td class="gl last-td"><span t-esc="o.amount_total"
                    t-options='{"widget": "float", "precision": 2}' /></td>
                </tr>
              </table>
              <p><span t-esc='(o.amount_in_word(o.amount_total)).capitalize()' /></p>
        
              <div class="igaser-footer">
                <div class="txt">
                  <p>
                    SARL au capital de 40.000.000,00 dh - siège social : lot 313-315 Zone
                    industriel-El Jadida - ICE: 000087398000070
                  </p>
                  <p>
                    Tel: 05 23 35 29 00 - Fax: 05 23 35 29 01 - PatenteL 42104582 - RC: 3013
                    - CNSS: 2703892 - IF: 05701046
                  </p>
                </div>
                <img class='img' src="/accounting_igaser/static/src/img/pfEkrlb.jpeg" />
                <div class="clear"></div>
                <p class="website bold">www.igaser.com</p>
                <hr class="bar" />
              </div>
            </div>
          </t>
          <t t-else="">
            <t t-foreach="range(pages)" t-as="page">
              <div class="page">
                <img src="/building/static/src/img/logo.jpg" class="logo" />
                <br/>
                <div class="client-infos">
                  <p><span t-field="o.partner_id.name"/></p>
                  <p>ICE : <span t-field="o.partner_id.ice"/></p>
                  <p><span t-field="o.partner_id.street"/> <span t-field="o.partner_id.street2"/></p>
                  <p><span t-field="o.partner_id.city"/></p>
                </div>
                <div class="clear"></div>
                <p>Facture n°: <span t-field="o.name"/></p>
                <p>El jadida, Le <span t-esc='o.invoice_date.strftime("%d/%m/%Y")'/></p>
                <table class="header-table">
                  <tr>
                    <th width="70%">Objet</th>
                    <th>Référence</th>
                  </tr>
                  <tr>
                    <td><span t-esc='o.site_id.name' /></td>
                    <td><span t-esc="o.reference"/></td>
                  </tr>
                </table>
                <table class="main-table">
                  <tr>
                    <th>DÉSIGNATION</th>
                    <th>UNITÉ</th>
                    <th>QUANTITÉ</th>
                    <th>PRIX HT</th>
                    <th>MONTANT HT</th>
                  </tr>
                  <t t-set="last_id" t-value="lines[-1].id" />
                  <t t-foreach="lines[start:end]" t-as="line">
                      <t t-if="line.id == last_id">
                        <tr>
                          <td class="last-td">
                            <span t-esc='line.name' />
                          </td>
                          <td class="last-td">
                            <span t-esc='line.product_uom_id.name' />
                          </td>
                          <td class="last-td">
                            <span t-esc='line.quantity'
                              t-options='{"widget": "float", "precision": 2}' />
                          </td>
                          <td class="last-td">
                            <span t-esc='line.price_unit'
                              t-options='{"widget": "float", "precision": 2}' />
                          </td>
                          <td class="last-td">
                            <span t-esc='line.price_subtotal'
                              t-options='{"widget": "float", "precision": 2}' />
                          </td>
                        </tr>
                      </t>
                      <t t-else="">
                        <tr>
                          <td>
                            <span t-esc='line.name' />
                          </td>
                          <td>
                            <span t-esc='line.product_uom_id.name' />
                          </td>
                          <td>
                            <span t-esc='line.quantity'
                              t-options='{"widget": "float", "precision": 2}' />
                          </td>
                          <td>
                            <span t-esc='line.price_unit'
                              t-options='{"widget": "float", "precision": 2}' />
                          </td>
                          <td>
                            <span t-esc='line.price_subtotal'
                              t-options='{"widget": "float", "precision": 2}' />
                          </td>
                        </tr>
                      </t>
                  </t>
                  <t t-if="o.site_id.is_tax_exempt">
                    <tr>
                      <td class="last-td">Exonéré de TVA suivant attestation <span t-field="o.site_id.exemption_certificate_ref"/></td>
                      <td class="last-td"></td>
                      <td class="last-td"></td>
                      <td class="last-td"></td>
                      <td class="last-td"></td>
                    </tr>
                  </t>
                  <t t-if="page + 1 == pages">
                    <tr class="last-section">
                      <td colspan="2"></td>
                      <td class="gl" colspan="2">TOTAL H.T</td>
                      <td class="gl"><span t-esc="o.amount_untaxed" t-options='{"widget": "float", "precision": 2}' /></td>
                    </tr>
                    <tr class="last-section">
                      <td colspan="2"></td>
                      <td class="gl" colspan="2">TVA 20%</td>
                      <t t-if="o.site_id.is_tax_exempt">
                        <td class="gl">EXONEREE</td>
                      </t>
                      <t t-else="">
                        <td class="gl"><span t-esc="o.amount_tax"
                          t-options='{"widget": "float", "precision": 2}' /></td>
                      </t>
                    </tr>
                    <tr class="last-section">
                      <td colspan="2">Arrêtée la Présente Facture a la somme de:</td>
                      <td class="gl last-td" colspan="2">TOTAL T.T.C</td>
                      <td class="gl last-td"><span t-esc="o.amount_total"
                        t-options='{"widget": "float", "precision": 2}' /></td>
                    </tr>
                  </t>
                </table>
                <t t-if="page + 1 == pages">
                  <p><span t-esc='(o.amount_in_word(o.amount_total)).capitalize()' /></p>
                </t>
          
                <div class="igaser-footer">
                  <div class="txt">
                    <p>
                      SARL au capital de 40.000.000,00 dh - siège social : lot 313-315 Zone
                      industriel-El Jadida - ICE: 000087398000070
                    </p>
                    <p>
                      Tel: 05 23 35 29 00 - Fax: 05 23 35 29 01 - PatenteL 42104582 - RC: 3013
                      - CNSS: 2703892 - IF: 05701046
                    </p>
                  </div>
                  <img class='img' src="/accounting_igaser/static/src/img/pfEkrlb.jpeg" />
                  <div class="clear"></div>
                  <p class="website bold">www.igaser.com</p>
                  <hr class="bar" />
                </div>
              </div>
              
              <t t-set="start" t-value="start + 40" />
              <t t-set="end" t-value="end + 40" />
            </t>
          </t>
        </t>
      </t>
    </t>
  </template>
</odoo>